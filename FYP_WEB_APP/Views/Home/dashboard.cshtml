@*
    For more information on enabling MVC for empty projects, visit http://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
    ViewBag.Title = "Home Page";
    Layout = null;

    var date = ViewBag.Date;
    var student = ViewBag.Student;
    var list = ViewBag.List;
    Layout = "_Layout";

}

    <head>
        <link rel="stylesheet" href="~/css/style.css">
        <!--https://www.chartjs.org/-->
        <link rel="stylesheet" href="~/css/bootstrap.min.css">
        <script src="~/js/chart/Chart.min.js"></script>
        <script src="~/js/chart/utils.js"></script>
        <script src="~/js/bootstrap/popper.min.js"></script>
        <script src="~/js/bootstrap/bootstrap.min.js"></script>
        <script src="~/js/heatmap/heatmap.js"></script>
        <script src="~/js/heatmap/heatmap.min.js"></script>
        <script src="~/js/prism.js"></script>
        <!--loading js-->
        <script src="~/js/modernizr.js"></script>
        <script src="~/js/jquery/jquery-3.5.1.min.js"></script>
        <!--loading js-->

        <title>InB</title>
        <script>

            $(document).ready(function () {
                //navbar ui
                $('.navbar-nav .nav-link').removeClass('active');
                $("#index").addClass('active');

                //<!--loading js-->

            });

            $(window).load(function () {
                // Animate loader off screen
                $(".se-pre-con").fadeOut("fast");
            });
        </script>
        <!--Testing-->
        <style>
            canvas {
                -moz-user-select: none;
                -webkit-user-select: none;
                -ms-user-select: none;
            }
        </style>
        <!--Testing-->
    </head>

<!--loading page graphic-->
<div class="se-pre-con"></div>
<!--loading page graphic-->
<!--header-->
<!--<script src="header.js"></script>-->
<!--header-->

<div class="">
    <div class=" bg-light p-3">
        <div class="container-fluid">
            <div class="container-fluid ">
                <dt class=" h2"><b>Overall Usage</b></dt>
            </div>
            <div class="row ">
                <div class=" col-xl-4 col-sm">
                    <div class="card mb-3 shadow-sm h-100 p-3 justify-content-center align-items-center  ">
                        <div id="PowerUsageChart" class="flex-fill bd-highlight col-12 h-100"></div>
                        <script>
                        $(document).ready(function () {
                         $("#PowerUsageChart").load("@Html.Raw(Url.Action("DoughnutChart", "Home", new { title = "Power Usage", chartType = "doughnut", position = "right" }))", function () {});

                                    });

                        </script>
                    </div>
                </div>

                <div class=" col-xl-4 col-sm">
                    <div class="card mb-3 shadow-sm h-100 p-3 justify-content-center align-items-center">
                        <div id="DoughnutChart" class="flex-fill bd-highlight col-12 h-100"></div>
                        <script>
                        $(document).ready(function () {
                            $("#DoughnutChart").load("@Html.Raw(Url.Action("DoughnutChart", "Home", new { title = "Use Time", chartType = "doughnut", position = "right" }))", function () {});

                                    });

                        </script>
                    </div>
                </div>

                <div class=" col-xl-4 col-sm">
                    <div class="">
                        <div class="card mb-3 shadow-sm px-3 pt-3 pb-0">
                            Total Savings

                            <div class="text-right h2">
                                @ViewBag.TotalSavings
                            </div>

                        </div>
                    </div>
                    <div class="">
                        <div class="card mb-3 shadow-sm px-3 pt-3 pb-0 w-100">
                            Total Usage

                            <div class="text-right h2">
                                @ViewBag.TotalUsage
                                KW-h
                            </div>
                        </div>
                    </div>
                    <div class="">
                        <div class="card  shadow-sm px-3 pt-3 pb-0 ">
                            <div class="">
                                <div class=" d-flex flex-row ">
                                    <div class=" mb-4  w-50 ">
                                        Air Conditioning
                                    </div>
                                    <div class=" mb-4  w-25 text-right">
                                        @ViewBag.ACpower
                                    </div>
                                    <div class=" mb-4  w-25 text-right">KW-h</div>
                                </div>
                            </div>
                            <div class="">
                                <div class=" d-flex flex-row">
                                    <div class=" mb-4  w-50 ">
                                        Light
                                    </div>
                                    <div class=" mb-4  w-25 text-right">
                                        @ViewBag.LTpower
                                    </div>
                                    <div class=" mb-4  w-25 text-right">KW-h</div>
                                </div>
                            </div>
                            <div class="">
                                <div class=" d-flex flex-row">
                                    <div class=" mb-4  w-50 ">
                                        Humidifier
                                    </div>
                                    <div class=" mb-4  w-25 text-right">
                                        @ViewBag.HDpower
                                    </div>
                                    <div class=" mb-4  w-25 text-right">KW-h</div>
                                </div>
                            </div>
                            <div class="">
                                <div class=" d-flex flex-row">
                                    <div class=" mb-4  w-50 ">
                                        EXH_FAN
                                    </div>
                                    <div class=" mb-4  w-25 text-right">
                                        @ViewBag.EFpower
                                    </div>
                                    <div class=" mb-4  w-25 text-right">KW-h</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>



            </div>

        </div>

    </div>
    <div class=" bg-light p-3">

        <div class="col-md ">
            <div class="card shadow-sm w-100 h-100 p-3 justify-content-center align-items-center flex-row flex-wrap">

                <div style="width:75%;">
                    <canvas id="canvas"></canvas>
                </div>
                <br>
                <br>
                <script>
                   // var MONTHS = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
                    //
                    // record current 8 hours trend
                    //
                    var today = new Date();  
                    var time = today.getHours();
                    var config = {
                        type: 'line',
                        data: {
                            //only current 6 hours
                            labels: [(time - 7) + ':00', (time - 6) + ':00', (time - 5) + ':00', (time - 4) + ':00', (time - 3) + ':00', (time - 2) + ':00', (time - 1) + ':00', time + ':00'],
                            datasets: [
                                {
                                label: 'Room 348',
                                backgroundColor: 'red',
                                borderColor: 'red',
                                    data: [
                                    // data value
                                    12.30,11.30,10.20,12.30,11.00,10.40,10.20,10.40
                                ],
                                fill: false,
                                },
                                {
                                label: 'Room 350',
                                fill: false,
                                backgroundColor: window.chartColors.blue,
                                borderColor: window.chartColors.blue,
                                    data: [
                                    // data value
                                    
                                ],
                            }]
                        },
                        options: {
                            responsive: true,
                            title: {
                                display: true,
                                text: 'Room power consumption',
                                fontSize: 35
                            },
                            tooltips: {
                                mode: 'index',
                                intersect: false,
                            },
                            hover: {
                                mode: 'nearest',
                                intersect: true
                            },
                            scales: {
                                xAxes: [{
                                    display: true,
                                    scaleLabel: {
                                        display: true,
                                        labelString: 'Time'
                                    }
                                }],
                                yAxes: [{
                                    display: true,
                                    scaleLabel: {
                                        display: true,
                                        labelString: 'Device Usage(kWh)'
                                    }
                                }]
                            }
                        }
                    };

                    window.onload = function () {
                        var ctx = document.getElementById('canvas').getContext('2d');
                        ctx.font = "500px Arial";
                        window.myLine = new Chart(ctx, config);
                    };
                </script>

                <!---->
            </div>
        </div>
    </div>
</div>
<!--chart js-->
<!--
<script>
    var chartID = '';
    var charttitle = '';
    var chartType = '';
    var position = '';
    var devices = [];
    var devicesData = [];
    var gcolor = [];
    var gdata;
    var goption;

    getPowerUsageDate();
    var devices = [];
    var devicesData = [];
    var gcolor = [];
    getUsageTimeData();
    var devices = [];
    var devicesData = [];
    var gcolor = [];
    getUsageRecordData();
    var devices = [];
    var devicesData = [];
    getNumberOfDevicesData();


    async function getUsageRecordData() {

        charttitle = 'Devices Power Usage Record';

        chartID = 'UsageRecordChart';
        chartType = 'line';
        position = 'bottom';
        devices.push('deviceA');
        devices.push('deviceB');
        devices.push('deviceC');
        var day = [];
        var i;
        for (i = 0; i < 30; i++) {
            day.push(i);
        }

        devices.forEach(getRandomColor);
        //set chart data
        dataop = {
            labels: day,
            datasets: [{
                label: devices[0],
                borderColor: gcolor[0],
                fill: false,
                data: [65, 59, 80, 81, 56, 55, 40, 50, 60, 55, 30, 78],
            }, {
                label: devices[1],
                borderColor: gcolor[1],
                fill: false,
                data: [10, 20, 60, 95, 64, 78, 90, 80, 70, 40, 70, 89],
                spanGaps: false,
            }, {
                label: devices[2],
                borderColor: gcolor[2],
                fill: false,
                data: [30, 20, 80, 50, 64, 78, 100, 40, 50, 40, 75, 90],
                spanGaps: false,
            }

            ]
        };
        //set chart option
        goption = {
            title: {
                display: true,
                text: charttitle,
                fontSize: 25
            },
            legend: {
                display: true,
                position: position,
                labels: {
                    boxWidth: 20,
                    fontColor: '#111',
                    padding: 15
                }
            }
        };
        draw();

    }
    //--------------------------------------------------------------------------------------------
    async function getNumberOfDevicesData() {

        chartID = 'NumberOfDevicesChart';
        charttitle = 'Number Of Devices';
        chartType = 'horizontalBar';
        position = 'top';

        devices.push('deviceA');
        devices.push('deviceB');
        devices.push('deviceC');
        devicesData.push(10);
        devicesData.push(20);
        devicesData.push(25);
        devices.forEach(getRandomColor);
        //set chart data

        dataop = {
            labels: devices,
            datasets: [{
                data: devicesData,
                backgroundColor: gcolor,
                borderWidth: 1,
                borderColor: '#777',
                hoverBorderWidth: 3,
                hoverBorderColor: '#000',
                spanGaps: false

            }


            ]
        };
        //set chart option

        goption = {
            responsive: true,

            title: {
                display: true,
                text: charttitle,
                fontSize: 25
            },
            legend: {
                display: false
            }, scales: {
                yAxes: [{
                    display: false
                }]
            }


        };

        draw();

    }
    //---------------------------------------------------------------------------------
    function getRandomColor() {
        var letters = '0123456789ABCDEF';
        var color = '#';
        for (var i = 0; i < 6; i++) {
            color += letters[Math.floor(Math.random() * 16)];
        }
        gcolor.push(color);
    }

    function draw() {

        let myChart = document.getElementById(chartID).getContext('2d');
        // Global Options
        Chart.defaults.global.defaultFontFamily = 'Lato';
        Chart.defaults.global.defaultFontSize = 18;
        Chart.defaults.global.defaultFontColor = '#777';


        let barChart = new Chart(myChart, {
            type: chartType,//bar,horizontalBar,pie,line,doughnut,radar,polarArea
            data: dataop,
            options: goption
        });
    }
            //--------------------------------------------------------------------------

</script>-->
<!--chart js-->
